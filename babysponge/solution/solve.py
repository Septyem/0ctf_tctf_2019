from pwn import *
import string
from hashlib import sha256

def dopow():
    chal = c.recvline()
    post = chal[12:28]
    tar = chal[33:-1]
    c.recvuntil(':')
    found = iters.bruteforce(lambda x:sha256(x+post).hexdigest()==tar, string.ascii_letters+string.digits, 4)
    c.sendline(found)

#c = remote('127.0.0.1',10002)
c = remote('111.186.63.14',10001)
dopow()
msg0 = '2d593f1a0a487190b21dba87a429ca909a88144f14a8942bf0ee0b738c67d3cca5ea4b6760576ba8adbbb5e4455e17299e3f56e7e98718632a8bfcc67c84703feb806517d2cc2f518adca3d0532b3600c3e52ca0d03f432b911e694e40a082d03ac3db38ec4800bfc4e4db647a9a6dc6dbc872ff873f2f50e4f685e392ea4a317001203e6e35a1684ff7bb8649a1e7146973cb2627cc04f5e1c146851128e07b73dfe794a1ef1f7b9df84f148a2d38c42eb7703fa9b8279cd8110ccaa2288b1a151e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161'
msg1 = '38d62da23d912722640913cdc7cf76377d23bc0aa5f14fe5ffe5654af94fbead89f558ebbbbc3688551f8dbdbaca3e5501b8cc051dc92f90b65e0811ce2b1b397368466366d571a8a47716dea26d417783032bc69a9d051777a69a9115cc14a6606d95f6bf8c21616864665da5a8b26e6229eb99ca9ee741cb5fd7099325def2861006e18106a8b3f450b9bf4742bafea14ecb84a74b02dfe36c7301cefac7b63151e1da01293b8dbec1a4120ee9f34e4d8a54c4bbfcf5f0972d6ca40bf7d01c441e87d154cd24a96e1ec9e10a98a879af905a9edcf7fce86a440df17e63e75633f5055bc7924327a20623687a394a0d8784fedab39dee93288e7a0d167eeb6b6d328c3ee655ed0224ad7daf269e2938dcd88eda32f5b6808d93b980ebcaf1f0ad4ff3eeed2dcb693f97cf3aae2eabb08f4241d18d9fe3ea98a569f29fff3a7e18de5636c4fdee9f6a4dabee7b595e412379f5e0242e989050bea1a0e7cd1da822c8edfe8b3dc0823d7bcd1418c112565c5c5ea3f4d2262645e097dcf53a7686f8dcd6f36161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161'

c.sendlineafter('(hex)',msg0)
c.sendlineafter('(hex)',msg1)

c.interactive()
